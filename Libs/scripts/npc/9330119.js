importPackage(Packages.Apple.console.groups.setting); 


var status = -1;
var itemList = new Array(1102000,1102001,1102002,1102003,1102004,1102021,1102022,1102023,1102024,1302143,1302144,1302145,1302146,1312058,1312058,1312059,1312060,1312061,1322086,1322087,1322088,1322089,1332116,1332117,1332118,1332119,1332121,1332122,1332123,1332124,1342029,1342030,1342031,1342032,1372074,1372075,1372076,1372077,1382095,1382096,1382097,1382098,1402086,1402087,1402088,1402089,1412058,1412059,1412060,1412061,1422059,1422060,1422061,1422062,1432077,1432078,1432079,1432080,1442107,1442108,1442109,1442110,1452102,1452103,1452104,1452105,1462087,1462088,1462089,1462090,1472113,1472114,1472115,1472116,1482075,1482076,1482077,1482078,1492075,1492076,1492077,1492078,1122019,1052187,1052188,1052189,1052190,1052191,1072262,1072263,1072264,1112400,1082145,1082146,1112794,1112922,1022058,1032000,1032001,1032002,1032026,1032028,1032032,1032062,1082145,1082146,1082147,1082148,1082149,1082150,1022060,1072238,1072239,1002390,1082175,1082176,1082177,1082178,1082179,1302108,1302109,1302124,1302130,1312040,1322066,1312041,1322067,1312047,1322075,1332080,1332083,1332098,1372047,1372048,1372057,1382063,1382064,1382079,1402054,1402055,1402071,1412036,1412037,1412045,1422040,1422041,1422048,1432051,1432052,1432060,1442072,1442073,1442085,1452063,1452064,1452082,1462057,1462058,1462074,1472078,1472079,1472099,1482035,1482036,1142070,1142072,1142100,1142329,1102173,1102234,1102057,1102085,1102145,1102297,1102298,1102299,1012164,1012167,1012168,1012169,2340000,2049100,1003449,1003980,1003981,1003982,1003450,1003266,1032205,1022190,1302014,1302021,1372031,1372033,1302024,1302049,1302051,1302043,1302058,1302061,1302067,1302066,1302084,1302085,1302087,1302110,1302111,1302124,1302129,1302134,1302163,1302210,1322038,1322051,1302071,1302230,1302293,1312012,1312034,1312119,1312169,1322022,1322024,1322025,1322026,1422036,1322070,1372042,1492057,1492058,1012070,1012071,1012072,1012073);
			
var NpcName = "潮流轉蛋機";
var NpcItems = 5220000;
var GachItem = new Array(
				[1302147,1500,true],
				[1312062,1500,true],
				[1332120,1500,true],
				[1332125,1500,true],
				[1342033,1500,true],
				[1372078,1500,true],
				[1382099,1500,true],
				[1402090,1500,true],
				[1412062,1500,true],
				[1422063,1500,true],
				[1432081,1500,true],
				[1442111,1500,true],
				[1452106,1500,true],
				[1462091,1500,true],
				[1472117,1500,true],
				[1482079,1500,true],
				[1492079,1500,true],
				[1122024,800,true],
				[1122025,800,true],
				[1122026,800,true],
				[1122027,800,true],
				[1122028,800,true],
				[1112659,800,true],
				[1112665,800,true],
				[1032129,800,true],
				[1032171,800,true],
				[1122185,800,true],
				[1132084,800,true],
				[1132088,800,true],
				[1132136,800,true],
				[1132135,1500,true],
				[1432101,1500,true],
				[1102041,800,true],
				[1102084,800,true],
				[1102248,800,true],
				[1112915,800,true],
				[1102042,800,true],
				[1102086,800,true],
				[1022067,800,true],
				[1012170,1000,true],
				[1012171,2000,true],
				[1012172,2000,true],
				[2070019,2000,true],
				[1012173,2000,true],
				[1442190,1500,true],
				[4000111,500,true],
				[1012174,2000,true],
				[1112821,1000,true],
				[1052638,1500,true],
				[1072844,1500,true],
				[1003922,1500,true],
				[1442252,1500,true],
				[1432198,1500,true],
				[1442253,1500,true],
				[1092049,2000,true],
				[1372035,1500,true],
				[1372036,1500,true],
				[1372037,1500,true],
				[1372038,1500,true],
				[1372039,1500,true],
				[1372040,1500,true],
				[1372041,1500,true],
				[1072672,1500,true],
				[1442023,1000,true],
				[3015404,1500,true],
				[3010045,1500,true],
				
				[3015172,1500,true]
				);
				//物品ID,機率,是否上廣
function action(mode, type, selection) {
    if (mode == 1) {
	status++;
    } else {
	cm.dispose();
		return ;
    }
   if (status == 0) {
		if (cm.getPlayerStat("LVL") < 29) {
        cm.sendOk("你的等級不能小於30等.");
		 cm.safeDispose();
		}
	if (cm.haveItem(5220000, 1)) {
	    cm.sendYesNo("您身上有#b#t5220000##i5220000##k可以進行轉蛋。\r\n你確定要使用 #b潮流轉蛋機#k 進行轉蛋嗎?");
	} else {
	    cm.sendOk("不好意思!您沒有#b#t5220000##i5220000##k。");
	    cm.safeDispose();
	}
    } else if (status == 1) {
		var item;
		var gain = false;
		for(var i = 0 ; i < GachItem.length ; i++){
			var GItem = GachItem[i];
			if (Math.floor(Math.random() * GItem[1]) == 0) {
				item = cm.gainGachaponItem(GItem[0], 1 , GItem[2]);
				gain = true;
				break;
			}
		}
		if(!gain){
			var itemList = new Array(1102000,1102001,1102002,1102003,1102004,1102021,1102022,1102023,1102024,1302143,1302144,1302145,1302146,1312058,1312058,1312059,1312060,1312061,1322086,1322087,1322088,1322089,1332116,1332117,1332118,1332119,1332121,1332122,1332123,1332124,1342029,1342030,1342031,1342032,1372074,1372075,1372076,1372077,1382095,1382096,1382097,1382098,1402086,1402087,1402088,1402089,1412058,1412059,1412060,1412061,1422059,1422060,1422061,1422062,1432077,1432078,1432079,1432080,1442107,1442108,1442109,1442110,1452102,1452103,1452104,1452105,1462087,1462088,1462089,1462090,1472113,1472114,1472115,1472116,1482075,1482076,1482077,1482078,1492075,1492076,1492077,1492078,1122019,1052187,1052188,1052189,1052190,1052191,1072262,1072263,1072264,1112400,1082145,1082146,1112794,1112922,1022058,1032000,1032001,1032002,1032026,1032028,1032032,1032062,1082145,1082146,1082147,1082148,1082149,1082150,1022060,1072238,1072239,1002390,1082175,1082176,1082177,1082178,1082179,1302108,1302109,1302124,1302130,1312040,1322066,1312041,1322067,1312047,1322075,1332080,1332083,1332098,1372047,1372048,1372057,1382063,1382064,1382079,1402054,1402055,1402071,1412036,1412037,1412045,1422040,1422041,1422048,1432051,1432052,1432060,1442072,1442073,1442085,1452063,1452064,1452082,1462057,1462058,1462074,1472078,1472079,1472099,1482035,1482036,1142070,1142072,1142100,1142329,1102173,1102234,1102057,1102085,1102145,1102297,1102298,1102299,1012164,1012167,1012168,1012169,2340000,2049100,1003449,1003980,1003981,1003982,1003450,1003266,1032205,1022190,1302014,1302021,1372031,1372033,1302024,1302049,1302051,1302043,1302058,1302061,1302067,1302066,1302084,1302085,1302087,1302110,1302111,1302124,1302129,1302134,1302163,1302210,1322038,1322051,1302071,1302230,1302293,1312012,1312034,1312119,1312169,1322022,1322024,1322025,1322026,1422036,1322070,1372042,1492057,1492058,1012070,1012071,1012072,1012073);
			item = cm.gainGachaponItem(itemList[Math.floor(Math.random() * itemList.length)], 1);
		}

	if (item != -1) {
	    cm.gainItem(5220000, -1);
	    cm.sendOk("您已獲得 #b#t" + item + "##i" + item + "##k");
	} else {
	    cm.sendOk("檢查一下背包是否已滿。");
	}
	cm.safeDispose();
    }
}